@using System;
@using System.Net;
@using misfits_festival.Shared.Models;
@using Dapper;
@using Npgsql;
@using misfits_festival.Client.Services;
@using misfits_festival.Client.Pages;
@using System.Net.Http;

@inject Blazored.LocalStorage.ILocalStorageService localStore
@page "/"


<h1>Misfits Festival</h1>

<div class="brugerId">

    Velkommen til Misfits Festivals digitale hjemmeside!
    <br />
    <br />
    Skriv dit bruger id herunder:
    <br />
    <input @bind="brugerEmail" />
    <br />
    <button @onclick="UpdateLocalStorage">Save</button>
    <button @onclick="ClearLocalStorage">Clear</button>
    <br />
    Hvis du ikke har et bruger id, henvises til siden 'Opret ny bruger'.

</div>

@code{
    const string noteKey = "note";
    string brugerEmail = "";

    public async void UpdateLocalStorage()
    {
        await localStore.SetItemAsync(noteKey, brugerEmail);
    }

    public async void ClearLocalStorage()
    {
        brugerEmail = "";
        await localStore.ClearAsync();
    }

    protected override async Task OnInitializedAsync()
    {
        brugerEmail = await localStore.GetItemAsync<string>(noteKey);
    }
}
